<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ultimate Song Database</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background:
        linear-gradient(rgba(12, 12, 12, 0.8), rgba(12, 12, 12, 0.8)),
        url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
      background-size: cover;
      color: #f0f0f0;
      padding: 20px;
      min-height: 100vh;
    }
    h1 {
      text-align: center;
      color: #00e6ff;
      text-shadow: 0 0 5px #00e6ff;
      margin-bottom: 10px;
    }
    #search {
      margin: 10px auto;
      padding: 12px 15px;
      max-width: 600px;
      width: 100%;
      border-radius: 30px;
      border: none;
      background: rgba(0, 188, 212, 0.15);
      color: #e0f7fa;
      font-size: 1rem;
      box-shadow: inset 0 0 8px #00bcd4;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      display: block;
      outline: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }
    #search::placeholder {
      color: #b2ebf2;
    }
    #search:focus {
      background: rgba(0, 188, 212, 0.3);
      box-shadow: 0 0 10px #00bcd4;
      color: #fff;
    }
    #genreFilter {
      margin: 10px auto;
      padding: 12px 15px;
      max-width: 600px;
      width: 100%;
      border-radius: 30px;
      border: none;
      background: rgba(0, 188, 212, 0.15);
      color: #e0f7fa;
      font-size: 1rem;
      box-shadow: inset 0 0 8px #00bcd4;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      display: block;
      outline: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }
    #genreFilter option {
      background-color: #222;
      color: #e0f7fa;
    }
    #genreFilter:focus {
      background: rgba(0, 188, 212, 0.3);
      box-shadow: 0 0 10px #00bcd4;
      color: #fff;
    }
    #assistantPanel {
      background-color: rgba(34, 34, 34, 0.85);
      border-radius: 8px;
      padding: 15px;
      margin-top: 30px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 0 10px #00e6ff;
      color: #b2ebf2;
    }
    #assistantPanel h3 {
      color: #00e6ff;
      margin-top: 0;
    }
    #assistantPanel ul {
      margin-left: 20px;
      list-style-type: disc;
    }
    form {
      max-width: 700px;
      margin: 30px auto 0 auto;
      background-color: rgba(20, 20, 20, 0.85);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 12px #00bcd4;
      display: none;
      flex-wrap: wrap;
      gap: 15px;
    }
    form input[type="text"],
    form input[type="number"] {
      flex: 1 1 45%;
      padding: 10px 12px;
      border-radius: 6px;
      border: none;
      background-color: #10191f;
      color: #fff;
      box-shadow: inset 0 0 5px #00bcd4;
      font-size: 1rem;
    }
    form input::placeholder {
      color: #a0cfdc;
    }
    form button {
      padding: 12px 25px;
      background-color: #00bcd4;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 0 8px #00bcd4;
      font-size: 1rem;
      margin-top: 10px;
    }
    form .form-buttons {
      flex-basis: 100%;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 10px;
    }
    table {
      margin: 20px auto 40px auto;
      max-width: 1000px;
      width: 100%;
      border-collapse: collapse;
      background-color: rgba(31, 31, 31, 0.9);
      box-shadow: 0 0 10px #00e6ff;
    }
    th, td {
      border: 1px solid #333;
      padding: 10px;
      text-align: left;
      vertical-align: middle;
    }
    th {
      background-color: #292d3e;
      color: #00e6ff;
    }
    td {
      background-color: #1a1f2e;
      color: #d0e8ff;
    }
    button.action-btn {
      margin-right: 6px;
      padding: 6px 10px;
      background-color: #00bcd4;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
      font-size: 0.9rem;
      box-shadow: 0 0 6px #00bcd4;
      transition: background-color 0.3s ease;
    }
    button.action-btn:hover {
      background-color: #0097a7;
    }
    #toggleFormBtn {
      display: block;
      margin: 30px auto 0 auto;
      padding: 12px 25px;
      background-color: #00bcd4;
      border: none;
      border-radius: 30px;
      color: white;
      cursor: pointer;
      font-size: 1.1rem;
      box-shadow: 0 0 10px #00bcd4;
      max-width: 300px;
      width: 100%;
      transition: background-color 0.3s ease;
    }
    #toggleFormBtn:hover {
      background-color: #0097a7;
    }
  </style>
</head>
<body>

<h1>üéß My Ultimate Song Database</h1>

<div id="assistantPanel">
  <h3>üéµ Song Assistant</h3>
  <p>Welcome, Praveen! Here's what your assistant can do:</p>
  <ul>
    <li>üîç Search by title in the box above</li>
    <li>üé§ Click <strong>Get Lyrics</strong> for official song pages</li>
    <li>üé® Filter by genre for mood-based playlists</li>
    <li>üõ†Ô∏è Use Edit/Delete to shape your collection</li>
    <li>üîê Add/Edit/Delete is password protected</li>
  </ul>
  <p style="font-style:italic; color:#aaa;">Let the playlist become your galaxy. üåå</p>
</div>

<input type="text" id="search" placeholder="Search by title...">
<select id="genreFilter">
  <option value="">Filter by genre</option>
</select>

<button id="toggleFormBtn">Add Song</button>

<form id="songForm">
  <input type="text" id="title" name="title" placeholder="Title" required>
  <input type="text" id="artist" name="artist" placeholder="Artist" required>
  <input type="text" id="album" name="album" placeholder="Album">
  <input type="text" id="genre" name="genre" placeholder="Genre">
  <input type="number" id="year" name="year" placeholder="Year">
  <input type="text" id="duration" name="duration" placeholder="Duration (e.g. 3:45)">
  <input type="text" id="location" name="location" placeholder="File Location or URL">
  <input type="text" id="mood" name="mood" placeholder="Mood/Theme">
  <input type="text" id="notes" name="notes" placeholder="Extra Notes">
  <div class="form-buttons">
    <button type="submit" id="submitBtn">Add Song</button>
    <button type="button" id="cancelBtn">Cancel</button>
  </div>
</form>

<table>
  <thead>
    <tr>
      <th>Title</th><th>Artist</th><th>Album</th><th>Genre</th><th>Year</th>
      <th>Duration</th><th>Location</th><th>Mood</th><th>Notes</th><th>Actions</th>
    </tr>
  </thead>
  <tbody id="songTableBody"></tbody>
</table>

<script>
  const PASSWORD = "Omega50%go";
  let authenticated = false;
  let editingIndex = -1;

  const songs = JSON.parse(localStorage.getItem("songs")) || [];

  const form = document.getElementById('songForm');
  const search = document.getElementById('search');
  const genreFilter = document.getElementById('genreFilter');
  const toggleFormBtn = document.getElementById('toggleFormBtn');
  const submitBtn = document.getElementById('submitBtn');
  const cancelBtn = document.getElementById('cancelBtn');
  const tableBody = document.getElementById('songTableBody');

  function requireAuth(callback) {
    if (!authenticated) {
      const entered = prompt("Enter password to unlock editing:");
      if (entered === PASSWORD) {
        authenticated = true;
        alert("Access granted. Edit mode is now active.");
        callback();
      } else {
        alert("Incorrect password.");
      }
    } else {
      callback();
    }
  }

  function escapeHTML(text) {
    return text.replace(/'/g, "\\'");
  }

  function renderTable() {
    tableBody.innerHTML = '';
    const searchValue = search.value.trim().toLowerCase();
    const genreValue = genreFilter.value.toLowerCase();

    const filteredSongs = songs.filter(song => {
      const titleMatch = song.title.toLowerCase().includes(searchValue);
      const genreMatch = genreValue === '' || (song.genre && song.genre.toLowerCase() === genreValue);
      return titleMatch && genreMatch;
    });

    filteredSongs.forEach((song, index) => {
      const row = document.createElement('tr');
      Object.values(song).forEach(val => {
        const cell = document.createElement('td');
        cell.textContent = val;
        row.appendChild(cell);
      });

      const actions = document.createElement('td');
      actions.innerHTML = `
        <button class="action-btn" onclick="editSong(${index})">Edit</button>
        <button class="action-btn" onclick="deleteSong(${index})">Delete</button>
        <button class="action-btn" onclick="getLyrics('${escapeHTML(song.title)}', '${escapeHTML(song.artist)}')">Get Lyrics</button>
      `;
      row.appendChild(actions);
      tableBody.appendChild(row);
    });
  }

  function saveData() {
    localStorage.setItem("songs", JSON.stringify(songs));
  }

  function updateGenreOptions() {
    const genres = [...new Set(songs.map(s => s.genre).filter(g => g && g.trim() !== ''))];
    genres.sort();

    genreFilter.innerHTML = '<option value="">Filter by genre</option>';
    genres.forEach(genre => {
      const option = document.createElement('option');
      option.value = genre.trim().toLowerCase();
      option.textContent = genre.trim();
      genreFilter.appendChild(option);
    });
  }

  function clearForm() {
    form.reset();
    editingIndex = -1;
    submitBtn.textContent = 'Add Song';
  }

  function showForm() {
    form.style.display = 'flex';
    toggleFormBtn.style.display = 'none';
  }

  function hideForm() {
    form.style.display = 'none';
    toggleFormBtn.style.display = 'block';
    clearForm();
  }

  toggleFormBtn.addEventListener('click', () => {
    requireAuth(() => {
      showForm();
    });
  });

  cancelBtn.addEventListener('click', () => {
    hideForm();
  });

  form.addEventListener('submit', e => {
    e.preventDefault();
    requireAuth(() => {
      const newSong = {
        title: form.title.value.trim(),
        artist: form.artist.value.trim(),
        album: form.album.value.trim(),
        genre: form.genre.value.trim(),
        year: form.year.value.trim(),
        duration: form.duration.value.trim(),
        location: form.location.value.trim(),
        mood: form.mood.value.trim(),
        notes: form.notes.value.trim()
      };

      if (newSong.genre) {
        newSong.genre = newSong.genre.charAt(0).toUpperCase() + newSong.genre.slice(1).toLowerCase();
      }

      if (editingIndex > -1) {
        songs[editingIndex] = newSong;
      } else {
        songs.push(newSong);
      }

      songs.sort((a, b) => a.title.localeCompare(b.title));
      saveData();
      updateGenreOptions();
      renderTable();
      hideForm();
    });
  });

  function deleteSong(index) {
    requireAuth(() => {
      if (confirm(`Are you sure you want to delete "${songs[index].title}"?`)) {
        songs.splice(index, 1);
        saveData();
        updateGenreOptions();
        renderTable();
      }
    });
  }

  function editSong(index) {
    requireAuth(() => {
      const song = songs[index];
      form.title.value = song.title;
      form.artist.value = song.artist;
      form.album.value = song.album;
      form.genre.value = song.genre;
      form.year.value = song.year;
      form.duration.value = song.duration;
      form.location.value = song.location;
      form.mood.value = song.mood;
      form.notes.value = song.notes;
      editingIndex = index;
      submitBtn.textContent = 'Save Changes';
      showForm();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }

  function getLyrics(title, artist) {
    const query = encodeURIComponent(`${title} ${artist} lyrics`);
    const url = `https://www.google.com/search?q=${query}`;
    window.open(url, '_blank');
  }

  search.addEventListener('input', renderTable);
  genreFilter.addEventListener('change', renderTable);

  updateGenreOptions();
  renderTable();
</script>

</body>
</html>
